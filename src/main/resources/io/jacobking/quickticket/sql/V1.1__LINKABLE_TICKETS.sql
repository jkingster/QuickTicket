CREATE TABLE IF NOT EXISTS LINKED_TICKET
(
    ID        INTEGER PRIMARY KEY AUTOINCREMENT,
    TICKET_ID INTEGER NOT NULL REFERENCES TICKET (ID),
    LINKED_ID INTEGER NOT NULL REFERENCES TICKET (ID)
);

ALTER TABLE TICKET
    ADD COLUMN RESOLVED_BY TEXT DEFAULT NULL;

CREATE TABLE IF NOT EXISTS TICKET_CATEGORIES
(
    ID          INTEGER PRIMARY KEY AUTOINCREMENT,
    "NAME"      TEXT NOT NULL,
    COLOR       TEXT NOT NULL DEFAULT '#5DADD5',
    DESCRIPTION TEXT NOT NULL DEFAULT ''
);

INSERT INTO TICKET_CATEGORIES (ID, NAME)
VALUES (0, 'DEFAULT');

ALTER TABLE TICKET
    ADD COLUMN CATEGORY_ID INT NOT NULL DEFAULT 0;

CREATE TABLE IF NOT EXISTS INVENTORY
(
    ID               INTEGER PRIMARY KEY AUTOINCREMENT,
    ASSET_NAME       TEXT    NOT NULL,
    ASSET_DESC       TEXT    NOT NULL DEFAULT 'Not provided.',
    TOTAL_COUNT      INTEGER NOT NULL DEFAULT 0,
    LAST_ISSUED      INTEGER NOT NULL REFERENCES EMPLOYEE (ID),
    LAST_ISSUED_DATE TEXT    NOT NULL
);

CREATE TABLE IF NOT EXISTS INVENTORY_LOG
(
    ID            INTEGER PRIMARY KEY AUTOINCREMENT,
    ASSET_ID      INTEGER NOT NULL REFERENCES INVENTORY (ID),
    COUNT_AT_TIME INTEGER NOT NULL,
    EMPLOYEE_NAME INTEGER NOT NULL REFERENCES EMPLOYEE (ID),
    ISSUED_DATE   TEXT    NOT NULL
);